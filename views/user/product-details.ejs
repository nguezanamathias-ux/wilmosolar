<%- include('../partials/header') %>

<div class="container product-detail">
    <h1 class="page-title">
        <img src="/images/icons/products.svg" alt="Produit" class="title-icon">
        <%= product.name %>
    </h1>

    <div class="product-detail-grid">
        <div class="product-card">
            <div class="product-image">
                <% if (product.image_url) { %>
                    <img src="<%= product.image_url %>" alt="<%= product.name %>">
                <% } else { %>
                    <img src="/images/logo.png" alt="Produit" class="product-fallback-icon">
                <% } %>
                <% if (roi >= 900) { %>
                    <span class="product-badge best">Meilleur ROI</span>
                <% } else if (product.price >= 50000) { %>
                    <span class="product-badge popular">Populaire</span>
                <% } %>
            </div>
        </div>

        <div class="product-detail-info">
            <div class="product-price"><%= product.price.toLocaleString() %> FCFA</div>
            <div class="product-return"><img src="/images/icons/income.svg" alt="" class="label-icon"> <%= product.daily_earnings.toLocaleString() %> FCFA/jour</div>
            <div class="product-total">Total sur <%= product.duration_days %> jours: <strong><%= totalReturn.toLocaleString() %> FCFA</strong></div>
            <div class="product-roi">ROI total: <strong><%= roi %>%</strong></div>
            <div class="product-description"><%= product.description %></div>

            <div class="product-actions">
                <a class="btn btn-secondary" href="/user/products">Retour</a>
                <% if (userBalance >= product.price) { %>
                    <form action="/user/products/buy/<%= product.id %>" method="POST">
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                        <button type="submit" class="btn btn-buy">Acheter</button>
                    </form>
                <% } else { %>
                    <button class="btn btn-buy" disabled>Solde insuffisant</button>
                <% } %>
            </div>
        </div>
    </div>
</div>

<%- include('../partials/bottom-nav') %>
<%- include('../partials/footer') %>
